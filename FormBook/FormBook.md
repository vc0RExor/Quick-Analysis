# _Overview

_FormBook is a malware which has been used by different groups, it is mainly attributed to Cobalt Group | Cobalt Spider, although it has been used by others such as Sweed, groups dedicated to financing and espionage, being FormBook a backdoor and an InfoStealer, it has had a great notoriety in recent years. In the waves of campaigns in which FormBook has been involved, it has been one of the most used accesses to the infrastructures, the abuse of SpearPhishing (T1566.002) will go through different phases up to the connection with a C&C._

# _Technical Anlysis

An outline of how the thread of execution of a FormBook sample would work would be as follows:

![image](https://user-images.githubusercontent.com/91592110/170861720-59f2ab8f-1c02-4811-aebe-45c9b58b9fc3.png)

This Malware has variants, interspersed with injections, scripting, etc.

Once downloaded after phishing the attached document, commonly using DOCX/RTF or XLS, we would obtain a file with macros or embedded objects.

![image](https://user-images.githubusercontent.com/91592110/170861747-531efec8-0a1b-4da5-b0e7-7a0abf5a2bd1.png)

Upon execution we would see an exploit of Microsoft Office Equation Editor CVE-2017-11882 (EQNEDT32.exe), which will exploit the vulnerability by executing code outside of the process memory

![image](https://user-images.githubusercontent.com/91592110/170861765-c766caed-e944-46d3-812d-9a6b4ffe1c98.png)

Immediately after exploitation, we observe how a file has been launched in a temporary folder usually TEMP or Roaming, which was downloaded by EQNEDT32 on a malicious domain

![image](https://user-images.githubusercontent.com/91592110/170880101-bd3c9153-d356-46f8-b5c6-7068f3d4d2b7.png)

![image](https://user-images.githubusercontent.com/91592110/170880106-f0494a60-db74-4db8-ad6e-88f7a73b16a2.png)

![image](https://user-images.githubusercontent.com/91592110/170880113-adaacd9b-ce2b-4327-a99f-49227a9225eb.png)

After the reversing of this file, we would find another Portable executable (PE)

![image](https://user-images.githubusercontent.com/91592110/170880189-0e4fc9c5-dc7c-482d-a713-a2eea545123a.png)

Later dealing with chain and obfuscation in debugging, we would find a library

![image](https://user-images.githubusercontent.com/91592110/170880214-0fd6e872-92b9-410d-af9a-d81354baf329.png)

This DLL has been widely reported, so we can guess that this step is quite common and does not usually use very different binaries in later phases

![image](https://user-images.githubusercontent.com/91592110/170880226-a6bd6631-7b81-41a7-9e13-af75f04fd3cf.png)

This library will be injected into explorer.exe, so we will see the functions of, depending on versions, Keylogging, Stealing, etc.. Which will always be the point of interest a connection to a C&C in which it will send all the relevant information of the computer or the user.

Specifically this sample makes requests to the following domains from explorer.exe:

```
www.heyconi[.]com
www.executrainpr[.]com
```

The most common thing in FormBook is, after the injection, auto-delete the files previously launched in temporary paths, for which they usually use commands with cmd.exe or Powershell.exe.

# _IOC

```
16a81a265cea156034bea5db891d480535cf697bdd8c8917fc6d994c33ddfdf0
6a1304d1c9897938d2217e62aee0f4a79af9535dce964f0661e67139948a380e
075f41c576c8e20d1ec1981a5e4197d514030c69dd653dfc2b94edf5088a0671
363c3288efc15bdba3db28988766e6554fca04e6bcb49e094f7a521388016fe8
45734f6c2bf14e396031f665963c7f03e74c1b989a58111a1f5dcf2c05d1e5fc
1ec2c2c0a29c16146400c52880e887cfae57223b2b621c0f433ef9b619af5343
02cda7e8e87599f480515b611d57653429825d45dbfd2bcee0b9f1ea8e845fc6
e4769e3e2b77ecaf145799bbd14fc3ebe7b7032f12f34807c59f59cee8eb063d
0e3a4f080d2ff0bdfa0a7e39df4982232b2d19245e6355e49940c05becfeecc5
03fa6bc991b15a3d5cd507673d1cccd0b0279315e9a04924d908a9520609a1c3
a734d235386d77a1c6a88bdf63efce5134a82a90e113be647200401b717b891e
f6b976e82b1b830539413b6356f8f2d61432bc2f59d5dfa2833bcab6ed4b3885
f080b3ba979f854761526f4bc6bd5b8210b48d5f91f15b1a1423849107775e11
bd89fe68b099ed00bea985dbdf7c8c0d87deb5a85c29d7a27f09764ab5b9d04d
bcd31729e663369b99fd178377977c5de078512046d2cb4b38c51d80d9801374
15e17fe1832e832ad58893aa8d5f2e8e33e2fa756d509d2e855daa6a1f4d4027
2979a77144d0df70f4dff084420d8e034eb6f751027fa44d158de924960f2a6a
eddc1ee1fafda4fe7cf6d114276c992806f33d7527d346464bad7033875fbd66
b1151fa2ddbc4bedbd3bcd7112ff359747776e38a7a57d20572ffaae4170d485
0d49317865221f81e49e88f6473af6639f15725fa9c894d1d4ee605de3951b65
6796f10e7f6140f26a49bf9446b2c75dfe0e6dc7d7d88cad5e09d9b608107851
8535282c1740725ecf68a65e9ce582a5fe28db4ffcfcd07e6b1516d62cc9dc60
2a25e0a533b850782b1fff19767de5ef74df1c9c02541c510f68d42dddf35cb5
b5e186f373c99f75db50a9b6689f835d4c141c6f369fa63d58da21b5fa13e90d
8dca7773c881a5f13083046667a97227e4d2ff0b833300ae8b9ae731847dc7ca
1868d031ba42f5f9b2f176f218647509ebcbf1171ed0da75a594a26744d03d9a
59513c88f8f80d7a7c871c8f31f7bdf3e96d9831ec74ee9563845c202957a9cf
10e55528343098fef510828eea445cddd10d15d04e119ccadc3745c19adc458c
9f3d95b9160149fcdfd2d59114d87917abd2a8b903e1e3f5ccbdae11b1c28d68
6a4dcd405fe4ec854fd0bfa69f852b2a53e4cfa8bed45c7affeb4f86e963cb08
dd60e55c229563801df128c29f52b21bc1cf22625c8b4b9442b2d7839c9175a4
5c8cdc3745711d1054704b8663828b005aa7a66535b0004c0364bc5cff832ddc
5d63cb62e9c2099fa70b843c45883c69237a557d5d7198499c37a95789f00bd4
f46d6d7bf1c9f466498c2a11c9c96fcc594c3490db04e763f81e7552f7ae6764
b01c10020580708d2d28cd94e8ec15fba89d16794a788d0a09928fb2af068117
669281f9aa118bef43b360b346e7954d6e1e9f04da0c8bff68387a2730c8e928
25966cc19f04cbbdacdf04249247d606c037cb527669addbfb0d52e0cd948519
edcbff4e011d46b1c1918479985c8bb094d02cdf9494f87903df9faeb6555c09
24b22264a9954fe9763f2a35d92088be412600ae1e0e6fc8586925a18216c967
0f87b6c475a0eddbf33a364ed0fbef4f5cd19f8d4776ffad5d0bf0db9d63fc42
ce757f9bd6a6ba9c9b7b27d3923b1dfca6e82b6a955fdf92c91975db6b1abdfb
5d6683dd926e5e76d11b522fdc8037584d272a5e4fd3a71274acfb4b2e663497
127250091242413bfb4b360d4ce13d926fbf85a38af2064e0fb73332b526bfad
67df49c1f0f94c41c91df4cb71835b1e188d19a19b5eb1346f1e0da4444d13d0
e17bfb8370c8badf90756f650e1be4794e77a57abb3619c30789364756304759
cd055a7b832bc32db20e93992cbc4df3698599747d51ebbb091af91156f82dfb
7754ed56a4703d27cf7447a206cb22f1aa1063d35633062e44860d8652d3b3dc
766524a72025be11ab13f0d5fe4dfefc295e3d43776aea18bdd1f48406eb7e95
dad0603f527e69265ceddd96b09ff61a98841698d35b79ab72e5314ed1b1d2fa
15f2d230db5e36766301585f9db25513f00150e6ef6068505ab3415af17b3b0b
08bac2df27e5bc147a3fbc1eec996d1a9202dfe66cdd7cada83a21ae7ac45bbc
7e675bed2dcde312da5e4304573eebda886e61e542f5b40840bd37d5e90cafe5
8bb0378626735cca62f8512257a07c429847109d26d5383cd7eb4915ac13ea4e
5c31ec6dd2c16e34ac9c533b1e58e047e7da0e426909f41fb66a55372e3155e2
b1b671842ea0b17a67e78741ceb401ccee0907e55c7a365aa78bf17aebe8e356
a29867a44dc382a736370078a8f8ad7ef1f2d1ee9da27d07e1204ea34f3cafb0
8acf479508cca8603513d380e418178f465e0fa867c0e7e51df8b22ac763c134
2bba06807ad9fd0bdc1957a15f32c93b18f9663182e87d0a72956cf26142b497
a440ad6e3c6d444ce1566fb0f29b25314f7a503615c17a27acc6aab671d130ca
41e1a9d2e39315c76c908d4d40150e930898e6221bcd96187413beffc2572315
fc8dedb234d17ae5d5e58eaf372988114b82bd1a9defe9934e8d7738e15a88ab
b9148dfec92ec25753e9a70e51ef698bc44a66be852a84b6e5296f873cf0ea79
fdea12592b9bb743e5320d9222be5e3d38ea78d0f346eababaec749d31185e7e
7b129fd22e90e55cbdddfd760c4e86df11e2998fbb3ea126bb98b72c18997bb3
fa318879db358e490dc763417711d144a17bd5ad8061821a1e820521ebefac16
45e8352d78b438ccf83d36f8679b58110a7296d65619f92e1f06c5da5d349ff9
d5c2e24b2a27a822fd7a2611be1ed64daa804eab1819546030141407e28e941b
bc89bbfbb6a41a488a2ad9a1a55be9ba28b1ff3501a4d22072ead32b121836c9
eebc2ceadb7e9541112a27a583603fd284208f1e2d23329c726efcfc02244609
5b39db4d27b6a3c5822a06632dedb65df333f7ab938433ed4761eaf88cebf4e8
3d4f0f70fc18a3b464a938ffb32fb693329993738991b2fa2e2f1a3faf84e7b8
8ba9d40ae5f7da84438fa7b46c2ba376afc0aacf4d806a0c9d2bf323d4da21d3
3caaa84ffcbd28e8f6a95a11a8101508c06ee47dd00a93b0d52960e351e4a97c
5139afa0b3dc677c0a4f3cfdf93f65ede82a9ea6502ac87785603d5583e8f15a
c01d1ca58e3801fd34ad3ce6385454348ab04c58a7ac8522bb214960e6642d0f
dc473948da9ebd0cd7647b5894d0b84796d42010a965d94765330550f715b28e
95e3a34bb2edf3cb9eeccd4e08af7218a4580f945969da5ae948a47bd7f3bac1
d37adce208895b993397f3fe975bef95bdb4544837ea3017ed1f15ed7da9b1f8
86db6c461a0c42868398aa5dd8b95c1f2748cc05c444ba4840d6772ccedc1a33
8462fd9066d10c0507394c75d66c915e0bd04e4b7107dac752d7855abe3ee3da
98b28d84bb0b1479d10646a5d34d02f9e25718adc285634fb11d407188089e1d
c4dd940d7d23aba5aa3c4b6b2f09701180631fcfe0e5756cf242b16514824daf
8ddee8d21d6847b663197cd64682cafc4a34bcc0a86af6a5e82f0bddfa838aee
df1b0eef4f32a5c2527691175375962957db71bc913d37f6e71150e599b2b31c
62d4b809036b03226c7b5c36b6126d97cc1ecf915200146391bf05e74c58e874
ddc510c3b697c0c9d361f7ef5d62cb101d134a81dd76a25a4c08031afb6e936a
df45997fda4f29688fe71512f82e6b5cd826c917d3c269fd51c1fa32d4890ad4
c8cab98913ed816e5302e5d6bdf36b565088b35c0235e017879acba43219015b
855a1eca9c5b0a87ae4bd3c993fa9582807db1f7620e63d558f310826f17f5bb
bc56169e0d244106d996f013991bc22087310511ee4a5eb00605132970ece0aa
af6e8234a2211a8b50c4e4de3f8a268b3ee98cb6bdc94959c4f1cc88ab8e3b66
fd41933f53e4d9c08e9c7c17f22206bf6599dc9f912be87e2c09bb05a10013a5
e0047eef676c9123a68230bf0c600b067aa0783a934205d26c63d997c4fae82b
a9ccf164caf3f859b3233f50fd77ba7ca837317338d055841a414dcb60a757dd
d24ea1fb5048a0cad103d4e728f7089562bc3397d7e6cc5a7933a12ed4b658f1
62c5952200a46bc706021d3102ef6d4e8e11b854750156a770643107a2538ca2
4aaa5e4ef84050dc285108aab6c668adb84d69ff1e2233bcb2d0149478a4bfeb
7a34ef3a5f0d2db6674d93de3143d2469d8fa06bf450dc4c1609c97822e68f53
2da5d0fab4e517de649c1116c62b23202b6d4b46a99f1aa05d44d345d280ca10
89cdf1763a4e844821117df0e03d1447ec951fa3d512e53356c1af5c1a96b2d0
7230d625e58f4378e6bbd34d4ed2d55a79f3ad941d21efd18ba16e5afc7b00e4
b6fbd1e6813b72c6451666ad593bbf0eb259df260c3f3d2fcc962a5cb317c98b
18fffdf046406f3e77b5710a25907406275df9936a76b32977e0956b20d48612
01271534c6ea0137c8b7e38b66b13f34272d3196fd8e0926c2d24b3a7c4547fc
db912789ffc493f082adea43b0213611eb8f30691ec2496cf2ce534f67473cda
1cb12659200d6324c3c3507407da00197b47e73fdbbac955b1b0ea13828345ee
ea279885af5791b59110e398c288085ca4018a93233514d2baef1fc821540e3d
60fa13c5e86925ce4a8a7a957de158a478c5c16180f621e93da1adb12aba0195
85ce49f0532bcb23b394c9af68f6b816670d5deeba332c15aae2ed158a10f19e
3a3446d2795cada474dd50f01d0f71ac26898c4773a2fb87db675040a558a8dc
a00b755ef03464d7999af3d3cdaaa1c446d98e616856264b76173450306c5e68
5321a383609006479672cc42334489cbb2dcc17eeb8af688350a1d4bce1df3d0
65f71681c11a1bf83be0a343dd03afc5927e20d40487fe746156f3aaeedfd5d4
e2578171e1b9bcf0282b5246a8c6cb79829387a340ca70fecdc7c48c2f6ae24c
fbcdf1532a2095924283e9d60f013d107036cdebce2772bfaf41b429931fdf58
45396624a6baf645800513cdbc6111703399e137c63c4498c0e9cfbc99b141f9
05d32cd3b93a055d165a689e3c561d6b32a291449ef4dbb2477d7b4153d7583e
bdc4cafefa90b60f8a60053bd589de648061cb51ec80dd15785746d601b1a345
88839c72ad1124401faf0d4ba7c20799c0825fd14c45aed2b27f9eb068abafce
a36ca6406a273cb0d73b0c76e66c559cd140c1941024b37f6e89a10ba4a0e3d8
c234510a389c16b722b67ba7896e49c034a03d06bbe42a787f02522d25a9431d
e22cc7329a3ee317a838f8420bddbee282bf9667ff74ffc2fa446468639f5349
33eff767b99def77e4d5ca2586a16b3e573b38b675d03dad841761093f067227
7b0d50834f7903e476e8dd9be42c3e68e9efe722a65fc90e77e5e0f025476535
19a9ec9da618f09710fd8e6e1daec72377e05e78bd7469f33e203a9529d712fd
db10e161fe1e1e3c38b8865a487d134445fb0f07a5e8fe466f75948e2a605b5f
f2ac93d21112c60a3f5a2e0b2f86ca1b9ae688680754140d031b15752e2df6ba
6ccee842a4957d3410ae6163bb96a9b7739b3ffc3032dfeeb2a3c7b273ca5656
401a430936fe880e531de6c2476df50ed9be9e5bc9c8ea5149657b16b4a1eb84
222ad93c9537bc72a00d01aaeab70acaea61210fb0de3967d671920848c87b04
b4e446102081c3dda96a91145270f8a13ce318b708bea3921bc286e4c6fcc2a2
b0b3a059f434681f3f6cee2e2fcea6e91894255d7b63b0116d897b3e83b69e1a
6b7f36519cdc4a69ebc2e6986331da18741bdb3eaf1f6dc4bd7e8acc3db77382
494cf04c6406ba864ce890869984fa9e779751b0ad76c0e55ab28ec898d088b9
544e3462ef5a4adb7d39c3022a17d13b9eb55db435e38c55bd02b5433ea546b8
b8e464201936080cd2e6b7fe6e93a2b6a66622ab361fee8cf0dad92d1616b0d5
937e7a7aea799b2b5d57d66077d66567545fd2010149df9ff90e639ecad62386
3946f3036e103af4caf04607d09ead4968fc0240881596f5e95db307f260d898
f0b819044a3bd7d24e2adfcf4fbed1f6ba6ca0a93fe29b6abf5f6dfe5279b8c7
d640fe3968dbefc28ce7ae480b3e01578c6a1232087d7d17f96fbe35d89c19ae
c7b09601e132a1d10735f89dbec1fa98c2271b102d9a07b8bb41858775172312
4024f6526ce45d32b49b46ee1b708a84ffb68b8204abb231d76f850161f5b38c
fb410f778d6b9ee7fe146ddeef7601bb1428c737f01cdb6885aeafe6d25d5d18
298d3c150bbee5312da015cd6448e7dc47eddcda5a6ddd215072102b6ba9e9e3
0d6f7d870b27c6d1ad339d5d8f964913ca3830465ad33bc499b64c034991bc66
Bcde5526481770c7e19f3077b14396497bc21e751c509e0f9d4374f424b5e69a
bd7323675e66df34d833d17897c6f98e9848dd062be6f299f482c09a90de4255
C0ee1071e444f415f8b62856a0896f3b22e563f1bb4f03d14142583efe49a565


142.93.110.250
45.151.250.142
198.185.159.144
185.53.178.7
162.159.138.85
216.218.185.162
138.199.37.226
13.248.216.40
107.175.212.60
103.145.254.203
180.214.236.4
37.0.11.227
180.214.238.224
198.12.84.30
103.167.92.57
198.12.89.141
103.171.1.178
103.156.91.153
192.210.240.32
104.168.33.25
192.210.240.37
107.174.138.146
23.95.52.206
107.175.3.53
212.193.30.214
107.172.73.137
107.173.191.123
179.43.175.179
198.46.136.246


trieutin.com
dj.ruppersalimentos.com.br
prosperbusinessdepot.com
vitrifrig0.com
basbeigium.com
tatlub.com
rajparis.in
www.heyconi.com
www.executrainpr.com

```
> :t-rex: [vc0=Rexor](https://github.com/vc0RExor)  :detective:


